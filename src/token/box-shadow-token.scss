:root,
[ks-theme] {
  /*
    Box-shadow blur scaling:
    If --ks-brand-box-shadow-blur-factor is 1, blur = 0px
    If --ks-brand-box-shadow-blur-factor is 2, blur = 2 × --ks-spacing-m
    Formula: (factor - 1) * 2 * spacing-m
  */
  --ks-brand-box-shadow-control-blur: calc(
    (var(--ks-brand-box-shadow-blur-factor) - 1) * 2 * var(--ks-spacing-m) * 0.15
  );
  --ks-brand-box-shadow-card-blur: calc((var(--ks-brand-box-shadow-blur-factor) - 1) * 2 * var(--ks-spacing-m) * 0.5);
  --ks-brand-box-shadow-surface-blur: calc(
    (var(--ks-brand-box-shadow-blur-factor) - 1) * 2 * var(--ks-spacing-m) * 0.75
  );

  /*
    Opacity scaling:
    If --ks-brand-box-shadow-opacity-factor is 1, opacity = 0
    If --ks-brand-box-shadow-opacity-factor is 2, opacity = 1
    Formula: (factor - 1) * 1
  */
  --ks-box-shadow-opacity: calc((var(--ks-brand-box-shadow-opacity-factor) - 1) * 0.5);

  /*
    Spread scaling:
    If --ks-brand-box-shadow-spread-factor is 1, spread = -spacing-m
    If --ks-brand-box-shadow-spread-factor is 1.5, spread = 0
    If --ks-brand-box-shadow-spread-factor is 2, spread = spacing-m
    Formula: (spread-factor - 1.5) * 2 * spacing-m
    Example values:
      1   → -spacing-m
      1.5 → 0
      2   → spacing-m
  */
  --ks-box-shadow-spread: calc((var(--ks-brand-box-shadow-spread-factor) - 1.5) * 2 * var(--ks-spacing-m));

  --ks-box-shadow-card-base: 0 var(--ks-brand-box-shadow-card-blur) calc(var(--ks-brand-box-shadow-card-blur) * 3)
    var(--ks-box-shadow-spread) rgba(0, 0, 0, var(--ks-box-shadow-opacity));
  --ks-box-shadow-card-hover-base: 0 var(--ks-brand-box-shadow-card-blur) calc(var(--ks-brand-box-shadow-card-blur) * 3)
    var(--ks-box-shadow-spread) rgba(0, 0, 0, var(--ks-box-shadow-opacity));

  --ks-box-shadow-card-inverted-base: 0 var(--ks-brand-box-shadow-card-blur)
    calc(var(--ks-brand-box-shadow-card-blur) * 3) var(--ks-box-shadow-spread)
    rgba(0, 0, 0, var(--ks-box-shadow-opacity));
  --ks-box-shadow-card-inverted-hover-base: 0 var(--ks-brand-box-shadow-card-blur)
    calc(var(--ks-brand-box-shadow-card-blur) * 3) var(--ks-box-shadow-spread)
    rgba(0, 0, 0, var(--ks-box-shadow-opacity));

  // Control: smaller, sharper shadow for input fields
  --ks-box-shadow-control-base: 0 var(--ks-brand-box-shadow-control-blur)
    calc(var(--ks-brand-box-shadow-control-blur) * 2.5) var(--ks-box-shadow-spread)
    rgba(0, 0, 0, var(--ks-box-shadow-opacity));
  --ks-box-shadow-control-hover-base: 0 var(--ks-brand-box-shadow-control-blur)
    calc(var(--ks-brand-box-shadow-control-blur) * 2.5) var(--ks-box-shadow-spread)
    rgba(0, 0, 0, var(--ks-box-shadow-opacity));

  --ks-box-shadow-control-inverted-base: 0 var(--ks-brand-box-shadow-control-blur)
    calc(var(--ks-brand-box-shadow-control-blur) * 2.5) var(--ks-box-shadow-spread)
    rgba(0, 0, 0, var(--ks-box-shadow-opacity));
  --ks-box-shadow-control-inverted-hover-base: 0 var(--ks-brand-box-shadow-control-blur)
    calc(var(--ks-brand-box-shadow-control-blur) * 2.5) var(--ks-box-shadow-spread)
    rgba(0, 0, 0, var(--ks-box-shadow-opacity));

  // Surface: bigger, smoother shadow for large elements
  --ks-box-shadow-surface-base: 0 var(--ks-brand-box-shadow-surface-blur)
    calc(var(--ks-brand-box-shadow-surface-blur) * 2) var(--ks-box-shadow-spread)
    rgba(0, 0, 0, var(--ks-box-shadow-opacity));
  --ks-box-shadow-surface-hover-base: 0 var(--ks-brand-box-shadow-surface-blur) var(--ks-box-shadow-spread)
    rgba(0, 0, 0, var(--ks-box-shadow-opacity));

  --ks-box-shadow-surface-inverted-base: 0 var(--ks-brand-box-shadow-surface-blur)
    calc(var(--ks-brand-box-shadow-surface-blur) * 2) var(--ks-box-shadow-spread)
    rgba(0, 0, 0, var(--ks-box-shadow-opacity));
  --ks-box-shadow-surface-inverted-hover-base: 0 calc(var(--ks-brand-box-shadow-surface-blur) * 2)
    var(--ks-box-shadow-spread) rgba(0, 0, 0, var(--ks-box-shadow-opacity));
}

:root {
  --ks-box-shadow-card: var(--ks-box-shadow-card-base);
  --ks-box-shadow-card-inverted: var(--ks-box-shadow-card-inverted-base);

  --ks-box-shadow-control: var(--ks-box-shadow-control-base);
  --ks-box-shadow-control-inverted: var(--ks-box-shadow-control-inverted-base);

  --ks-box-shadow-surface: var(--ks-box-shadow-surface-base);
  --ks-box-shadow-surface-inverted: var(--ks-box-shadow-surface-inverted-base);

  --ks-box-shadow-card-hover: var(--ks-box-shadow-card-hover-base);
  --ks-box-shadow-card-inverted-hover: var(--ks-box-shadow-card-inverted-hover-base);

  --ks-box-shadow-control-hover: var(--ks-box-shadow-control-hover-base);
  --ks-box-shadow-control-inverted-hover: var(--ks-box-shadow-control-inverted-hover-base);

  --ks-box-shadow-surface-hover: var(--ks-box-shadow-surface-hover-base);
  --ks-box-shadow-surface-inverted-hover: var(--ks-box-shadow-surface-inverted-hover-base);
}

[ks-inverted="true"] {
  --ks-box-shadow-card: var(--ks-box-shadow-card-inverted-base);
  --ks-box-shadow-card-inverted: var(--ks-box-shadow-card-base);

  --ks-box-shadow-control: var(--ks-box-shadow-control-inverted-base);
  --ks-box-shadow-control-inverted: var(--ks-box-shadow-control-base);

  --ks-box-shadow-surface: var(--ks-box-shadow-surface-inverted-base);
  --ks-box-shadow-surface-inverted: var(--ks-box-shadow-surface-base);

  --ks-box-shadow-card-hover: var(--ks-box-shadow-card-inverted-hover-base);
  --ks-box-shadow-card-inverted-hover: var(--ks-box-shadow-card-hover-base);

  --ks-box-shadow-control-hover: var(--ks-box-shadow-control-inverted-hover-base);
  --ks-box-shadow-control-inverted-hover: var(--ks-box-shadow-control-hover-base);

  --ks-box-shadow-surface-hover: var(--ks-box-shadow-surface-inverted-hover-base);
  --ks-box-shadow-surface-inverted-hover: var(--ks-box-shadow-surface-hover-base);
}
